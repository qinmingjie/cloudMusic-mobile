{"ast":null,"code":"var _jsxFileName = \"E:\\\\github-project\\\\cloudMusic-mobile\\\\src\\\\component\\\\musiclist.js\";\nimport React, { Fragment, useState, useEffect } from \"react\";\nimport musiclist from \"../static/css/musiclist.module.css\";\nimport { getUrl } from \"../store/action/index\";\nimport { createStore } from \"redux\";\nimport dayjs from \"dayjs\";\nimport { useSelector, useDispatch } from \"react-redux\";\nexport default function MusicList(props) {\n  let {\n    data\n  } = props; // let [show,setShow] = useState(false)\n\n  let [musicLocation, setMuc] = useState(\"\");\n  let [musicSize, setSize] = useState();\n  useEffect(() => {// console.log(musicLocation)\n  }, [musicLocation]);\n  useEffect(() => {\n    let musiclist = document.querySelectorAll(\".musictr\");\n    let audio = document.querySelector(\"audio\");\n    let play = document.querySelector(\".playWrap\");\n    let cover = play.querySelector(\".cover\");\n\n    if (musiclist.length !== 0) {\n      [...musiclist].map((item, index) => {\n        item.onclick = function () {\n          let mucUrl = item.getAttribute(\"musicurl\");\n          let picUrl = item.getAttribute(\"album-id\");\n          getUrl(`/song/url?id=${mucUrl}`).then(res => {\n            let music = res.data.data[0].url;\n            console.log(music);\n\n            if (music !== null) {\n              cover.style.backgroundImage = `url(${picUrl})`;\n              cover.classList.add(\"anima\");\n              cover.style.animationPlayState = \"running\";\n              audio.setAttribute(\"src\", music);\n              play.querySelector(\".play\").style.display = \"block\";\n              play.querySelector(\".end\").style.display = \"none\";\n            } else {\n              alert(\"抱歉，暂时无法播放\");\n            }\n          });\n        };\n      });\n    }\n  }); //歌曲时间管理\n\n  function musicTimeReducer(time = {\n    data: [],\n    txt: \"123\"\n  }, action) {\n    if (action.type === \"time_data\") {\n      return {\n        data: action.data\n      };\n    }\n\n    return time;\n  }\n\n  let store = createStore(musicTimeReducer);\n\n  function getData(long) {\n    return new Promise((reslove, reject) => {\n      let str = \"\";\n      getUrl(`/song/url?id=${long}`).then(res => {\n        str += \",\" + res.data.data[0].size;\n        store.dispatch({\n          type: \"time_data\",\n          data: store.getState().data + str\n        });\n        return reslove(store.getState().data);\n      });\n    });\n  } // useEffect(()=>{\n  //     let span = document.querySelectorAll(\".timeElement\")\n  //     if(data){\n  //         console.log(data)\n  //         data.tracks.map((item,index)=>{\n  //             let newPro = new Promise((reslove,reject)=>{\n  //                 getData(item.id).then((res)=>{\n  //                     return reslove(res.split(\",\"))\n  //                 })\n  //             })\n  //             newPro.then((res)=>{\n  //                 store.dispatch({\n  //                     type:\"time_data\",\n  //                     data:res,\n  //                 })\n  //             }).then(()=>{\n  //                 let arr = store.getState().data.slice(1,)\n  //                 let el = [...span]\n  //                 // console.log(arr.length,el.length)\n  //                 if((el.length)===(arr.length)){\n  //                     // el[index].innerHTML = arr[index]\n  //                     el.map((item,index)=>{\n  //                         item.innerHTML = arr[index]\n  //                     })\n  //                 }\n  //             })\n  //         })\n  //     }\n  // })\n\n\n  return /*#__PURE__*/React.createElement(Fragment, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 9\n    }\n  }, data ? /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: musiclist.title,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 22\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 29\n    }\n  }, \"\\u6B4C\\u66F2\\u5217\\u8868\")), /*#__PURE__*/React.createElement(\"span\", {\n    className: musiclist.numbers,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 29\n    }\n  }, data.trackCount), \"\\u9996\\u6B4C\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: musiclist.playnumber,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 25\n    }\n  }, \"\\u64AD\\u653E\\uFF1A\", /*#__PURE__*/React.createElement(\"strong\", {\n    className: musiclist.red,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 66\n    }\n  }, data.playCount), \" \\u6B21\"), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 25\n    }\n  })), /*#__PURE__*/React.createElement(\"table\", {\n    className: musiclist.table,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"thead\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"tr\", {\n    className: musiclist.thead,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"th\", {\n    className: musiclist.head1,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 61\n    }\n  })), /*#__PURE__*/React.createElement(\"th\", {\n    className: musiclist.head2,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 61\n    }\n  }, \"\\u6B4C\\u66F2\\u6807\\u9898\")), /*#__PURE__*/React.createElement(\"th\", {\n    className: musiclist.head3,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 61\n    }\n  }, \"\\u65F6\\u957F\")), /*#__PURE__*/React.createElement(\"th\", {\n    className: musiclist.head4,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 61\n    }\n  }, \"\\u6B4C\\u624B\")), /*#__PURE__*/React.createElement(\"th\", {\n    className: musiclist.head5,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 61\n    }\n  }, \"\\u4E13\\u8F91\")))), /*#__PURE__*/React.createElement(\"tbody\", {\n    className: musiclist.tbody,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 21\n    }\n  }, data.tracks.map((item, index) => {\n    return /*#__PURE__*/React.createElement(\"tr\", {\n      key: item.id,\n      musicurl: item.id,\n      \"album-id\": item.al.picUrl,\n      hasshow: \"show\",\n      className: ((index + 1) % 2 === 0 ? \"\" : musiclist.gray) + \" \" + \"musictr\",\n      onMouseEnter: function (e) {\n        let parentnode = e.target;\n\n        function Parent() {\n          if (parentnode.parentElement.getAttribute(\"hasshow\")) {\n            parentnode.parentElement.querySelector(\"#time\").style.display = \"none\";\n            parentnode.parentElement.querySelector(\"#timeIcons\").style.display = \"block\";\n          } else {\n            parentnode = parentnode.parentElement;\n            Parent();\n          }\n        }\n\n        Parent();\n      },\n      onClick: e => {\n        {\n          /**该点击时间中都是异步操作，音乐地址需要在点击时获取这是有的数据没有请求到就会出错所以使用Promise来同步异步操作 */\n        }\n        getUrl(`/song/url?id=${item.id}`).then(res => {\n          function muc(Data) {\n            return new Promise((reslove, reject) => {\n              setMuc(Data);\n            });\n          }\n\n          muc(res.data.data[0].url).then(() => {\n            if (musicLocation === null) {\n              alert(\"为获取到版权,努力中！\");\n            }\n          });\n        });\n      },\n      onMouseLeave: function (e) {\n        let parentnode = e.target;\n\n        function Parent() {\n          if (parentnode.parentElement.getAttribute(\"hasshow\")) {\n            parentnode.parentElement.querySelector(\"#time\").style.display = \"block\";\n            parentnode.parentElement.querySelector(\"#timeIcons\").style.display = \"none\";\n          } else {\n            parentnode = parentnode.parentElement;\n            Parent();\n          }\n        }\n\n        Parent();\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 130,\n        columnNumber: 33\n      }\n    }, /*#__PURE__*/React.createElement(\"td\", {\n      className: musiclist.num,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 173,\n        columnNumber: 37\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 174,\n        columnNumber: 41\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      className: musiclist.icon1,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 175,\n        columnNumber: 45\n      }\n    }, \"\\xA0\"), /*#__PURE__*/React.createElement(\"span\", {\n      className: musiclist.num,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 176,\n        columnNumber: 45\n      }\n    }, index + 1))), /*#__PURE__*/React.createElement(\"td\", {\n      className: musiclist.muscName,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 179,\n        columnNumber: 37\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 180,\n        columnNumber: 41\n      }\n    }, item.name)), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184,\n        columnNumber: 37\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: musiclist.share,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 185,\n        columnNumber: 41\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      className: musiclist.time + \" \" + \"timeElement\",\n      id: \"time\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 186,\n        columnNumber: 45\n      }\n    }, String(item.dt / 1000 % 60) === \"0\" ? item.dt / 1000 / 60 < 10 ? \"0\" + item.dt / 1000 / 60 : item.dt / 1000 / 60 : String(item.dt / 1000 / 60).slice(0, String(item.dt / 1000 / 60).indexOf(\".\")) < 10 ? \"0\" + item.dt / 1000 / 60 : String(item.dt / 1000 / 60).slice(0, String(item.dt / 1000 / 60).indexOf(\".\")), \";\"), /*#__PURE__*/React.createElement(\"div\", {\n      className: musiclist.show,\n      id: \"timeIcons\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 192,\n        columnNumber: 45\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      className: musiclist.span1,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 193,\n        columnNumber: 49\n      }\n    }), /*#__PURE__*/React.createElement(\"span\", {\n      className: musiclist.span2,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 194,\n        columnNumber: 49\n      }\n    }), /*#__PURE__*/React.createElement(\"span\", {\n      className: musiclist.span3,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 195,\n        columnNumber: 49\n      }\n    }), /*#__PURE__*/React.createElement(\"span\", {\n      className: musiclist.span4,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 196,\n        columnNumber: 49\n      }\n    })))), /*#__PURE__*/React.createElement(\"td\", {\n      className: \"\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 200,\n        columnNumber: 37\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: musiclist.song,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 201,\n        columnNumber: 41\n      }\n    }, item.ar[0].name)), /*#__PURE__*/React.createElement(\"td\", {\n      className: \"\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 205,\n        columnNumber: 37\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: musiclist.album,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 206,\n        columnNumber: 41\n      }\n    }, item.al.name)));\n  })))) : \"\");\n}","map":{"version":3,"sources":["E:/github-project/cloudMusic-mobile/src/component/musiclist.js"],"names":["React","Fragment","useState","useEffect","musiclist","getUrl","createStore","dayjs","useSelector","useDispatch","MusicList","props","data","musicLocation","setMuc","musicSize","setSize","document","querySelectorAll","audio","querySelector","play","cover","length","map","item","index","onclick","mucUrl","getAttribute","picUrl","then","res","music","url","console","log","style","backgroundImage","classList","add","animationPlayState","setAttribute","display","alert","musicTimeReducer","time","txt","action","type","store","getData","long","Promise","reslove","reject","str","size","dispatch","getState","title","numbers","trackCount","playnumber","red","playCount","table","thead","head1","head2","head3","head4","head5","tbody","tracks","id","al","gray","e","parentnode","target","Parent","parentElement","muc","Data","num","icon1","muscName","name","share","String","dt","slice","indexOf","show","span1","span2","span3","span4","song","ar","album"],"mappings":"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","sourcesContent":["import React,{Fragment, useState, useEffect}from \"react\"\r\nimport musiclist from \"../static/css/musiclist.module.css\"\r\nimport {getUrl} from \"../store/action/index\"\r\nimport {createStore} from \"redux\"\r\nimport dayjs from \"dayjs\"\r\nimport {useSelector,useDispatch} from \"react-redux\"\r\nexport default function MusicList(props){\r\n    let {data} = props\r\n    // let [show,setShow] = useState(false)\r\n    let [musicLocation,setMuc] = useState(\"\");\r\n    let [musicSize,setSize] = useState()\r\n    useEffect(()=>{\r\n        // console.log(musicLocation)\r\n    },[musicLocation])\r\n    useEffect(()=>{\r\n        let musiclist = document.querySelectorAll(\".musictr\")\r\n        let audio = document.querySelector(\"audio\")\r\n        let play = document.querySelector(\".playWrap\")\r\n        let cover = play.querySelector(\".cover\")\r\n        if(musiclist.length!==0){\r\n            [...musiclist].map((item,index)=>{\r\n                item.onclick=function(){\r\n                    let mucUrl = item.getAttribute(\"musicurl\")\r\n                    let picUrl = item.getAttribute(\"album-id\")\r\n                    getUrl(`/song/url?id=${mucUrl}`).then((res)=>{\r\n                        let music = res.data.data[0].url;\r\n                        console.log(music)\r\n                        if(music!==null){\r\n                            cover.style.backgroundImage = `url(${picUrl})`;\r\n                            cover.classList.add(\"anima\")\r\n                            cover.style.animationPlayState = \"running\"\r\n                            audio.setAttribute(\"src\",music)\r\n                            play.querySelector(\".play\").style.display=\"block\"\r\n                            play.querySelector(\".end\").style.display=\"none\"\r\n                        }else{\r\n                            alert(\"抱歉，暂时无法播放\")\r\n                        }\r\n                    })\r\n                }\r\n            })\r\n        }\r\n        \r\n        \r\n    })\r\n\r\n    //歌曲时间管理\r\n    function musicTimeReducer(time={\r\n        data:[],\r\n        txt:\"123\"\r\n    },action){\r\n        if(action.type===\"time_data\"){\r\n            return {data:action.data}\r\n        }\r\n        return time\r\n    }\r\n    let store = createStore(musicTimeReducer);\r\n    function getData(long){\r\n        return new Promise((reslove,reject)=>{\r\n            let str=\"\"\r\n            getUrl(`/song/url?id=${long}`).then((res)=>{\r\n                str += \",\"+res.data.data[0].size\r\n                store.dispatch({\r\n                    type:\"time_data\",\r\n                    data:store.getState().data+str,\r\n                })\r\n                return reslove(store.getState().data)\r\n            })\r\n        })\r\n    }\r\n\r\n\r\n    // useEffect(()=>{\r\n    //     let span = document.querySelectorAll(\".timeElement\")\r\n    //     if(data){\r\n    //         console.log(data)\r\n    //         data.tracks.map((item,index)=>{\r\n    //             let newPro = new Promise((reslove,reject)=>{\r\n    //                 getData(item.id).then((res)=>{\r\n    //                     return reslove(res.split(\",\"))\r\n    //                 })\r\n    //             })\r\n    //             newPro.then((res)=>{\r\n    //                 store.dispatch({\r\n    //                     type:\"time_data\",\r\n    //                     data:res,\r\n    //                 })\r\n    //             }).then(()=>{\r\n    //                 let arr = store.getState().data.slice(1,)\r\n    //                 let el = [...span]\r\n    //                 // console.log(arr.length,el.length)\r\n    //                 if((el.length)===(arr.length)){\r\n    //                     // el[index].innerHTML = arr[index]\r\n    //                     el.map((item,index)=>{\r\n    //                         item.innerHTML = arr[index]\r\n    //                     })\r\n    //                 }\r\n    //             })\r\n    //         })\r\n    //     }\r\n    // })\r\n    return(\r\n        <Fragment>\r\n            {data?(\r\n                <div>\r\n                     <div className={musiclist.title}>\r\n                        <h3>\r\n                            <span>歌曲列表</span>\r\n                        </h3>\r\n                        <span className={musiclist.numbers}>\r\n                            <span>{data.trackCount}</span>首歌\r\n                        </span>\r\n                        <div className={musiclist.playnumber}>播放：<strong  className={musiclist.red}>{data.playCount}</strong> 次</div>\r\n                        <div>\r\n                        </div>\r\n                    </div>\r\n                <table className={musiclist.table}>\r\n                    <thead>\r\n                        <tr className={musiclist.thead}>\r\n                            <th className={musiclist.head1}><div></div></th>\r\n                            <th className={musiclist.head2}><div>歌曲标题</div></th>\r\n                            <th className={musiclist.head3}><div>时长</div></th>\r\n                            <th className={musiclist.head4}><div>歌手</div></th>\r\n                            <th className={musiclist.head5}><div>专辑</div></th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody className={musiclist.tbody}>\r\n                        {data.tracks.map((item,index)=>{\r\n                            \r\n                            return(\r\n                                <tr key={item.id} musicurl={item.id}  album-id={item.al.picUrl} hasshow=\"show\" className={(((index+1)%2===0)?\"\":musiclist.gray)+\" \"+\"musictr\"} \r\n                                onMouseEnter={function(e){\r\n                                    let parentnode = e.target;\r\n                                    function Parent(){\r\n                                        if(parentnode.parentElement.getAttribute(\"hasshow\")){\r\n                                           parentnode.parentElement.querySelector(\"#time\").style.display = \"none\";\r\n                                           parentnode.parentElement.querySelector(\"#timeIcons\").style.display = \"block\"\r\n                                        }else{\r\n                                            parentnode = parentnode.parentElement\r\n                                            Parent()\r\n                                        }\r\n                                    }\r\n                                    Parent()\r\n                                }}\r\n                                onClick={(e)=>{\r\n                                    {/**该点击时间中都是异步操作，音乐地址需要在点击时获取这是有的数据没有请求到就会出错所以使用Promise来同步异步操作 */}\r\n                                    getUrl(`/song/url?id=${item.id}`).then((res)=>{\r\n                                        function muc(Data){\r\n                                            return new Promise((reslove,reject)=>{\r\n                                                setMuc(Data)\r\n                                            })\r\n                                        }\r\n                                        muc(res.data.data[0].url).then(()=>{\r\n                                            if(musicLocation===null){\r\n                                                alert(\"为获取到版权,努力中！\")\r\n                                            }\r\n                                        })\r\n                                    })\r\n                                }}\r\n                                onMouseLeave={function(e){\r\n                                    let parentnode = e.target;\r\n                                    function Parent(){\r\n                                        if(parentnode.parentElement.getAttribute(\"hasshow\")){\r\n                                           parentnode.parentElement.querySelector(\"#time\").style.display = \"block\";\r\n                                           parentnode.parentElement.querySelector(\"#timeIcons\").style.display = \"none\"\r\n                                        }else{\r\n                                            parentnode = parentnode.parentElement\r\n                                            Parent()\r\n                                        }\r\n                                    }\r\n                                    Parent()\r\n                                }}\r\n                                >\r\n                                    <td className={musiclist.num}>\r\n                                        <div>\r\n                                            <span className={musiclist.icon1}>&nbsp;</span>\r\n                                            <span  className={musiclist.num}>{index+1}</span>\r\n                                        </div>\r\n                                    </td>\r\n                                    <td className={musiclist.muscName}>\r\n                                        <div>\r\n                                           {item.name}\r\n                                        </div>\r\n                                    </td>\r\n                                    <td>\r\n                                        <div className={musiclist.share}>\r\n                                            <span className={musiclist.time+\" \"+\"timeElement\"}  id=\"time\">\r\n                                                {String(item.dt/1000%60)===\"0\"?(item.dt/1000/60<10)?(\"0\" + item.dt/1000/60):item.dt/1000/60:String(item.dt/1000/60).slice(0,String(item.dt/1000/60).indexOf(\".\"))<10?\"0\"+item.dt/1000/60:String(item.dt/1000/60).slice(0,String(item.dt/1000/60).indexOf(\".\"))}\r\n                                                {\";\"}\r\n                                                {/* {item.dt%1000} */}\r\n                                                {/* {String((item.dt/1000/60)).slice(String((item.dt/1000/60)).indexOf(\".\")+1,String((item.dt/1000/60)).indexOf(\".\")+3)} */}\r\n                                            </span>\r\n                                            <div className={musiclist.show} id=\"timeIcons\">\r\n                                                <span className={musiclist.span1}></span>\r\n                                                <span className={musiclist.span2}></span>\r\n                                                <span className={musiclist.span3}></span>\r\n                                                <span className={musiclist.span4}></span>\r\n                                            </div>\r\n                                        </div>\r\n                                    </td>\r\n                                    <td className=\"\">\r\n                                        <div className={musiclist.song}>\r\n                                            {item.ar[0].name}\r\n                                        </div>\r\n                                    </td>\r\n                                    <td className=\"\">\r\n                                        <div className={musiclist.album}>\r\n                                            {item.al.name}\r\n                                        </div>\r\n                                    </td>\r\n                                </tr>\r\n                            )\r\n                        })}\r\n                        </tbody>\r\n                </table>\r\n                </div>\r\n               ):\"\"}\r\n        </Fragment>\r\n    )\r\n}"]},"metadata":{},"sourceType":"module"}