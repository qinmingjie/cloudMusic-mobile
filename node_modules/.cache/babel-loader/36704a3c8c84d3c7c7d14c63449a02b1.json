{"ast":null,"code":"function _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance\");\n}\n\nfunction _iterableToArray(iter) {\n  if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter);\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) {\n      arr2[i] = arr[i];\n    }\n\n    return arr2;\n  }\n}\n\nfunction _slicedToArray(arr, i) {\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest();\n}\n\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n}\n\nfunction _iterableToArrayLimit(arr, i) {\n  if (!(Symbol.iterator in Object(arr) || Object.prototype.toString.call(arr) === \"[object Arguments]\")) {\n    return;\n  }\n\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nimport { useCallback, useMemo, useState } from 'react';\nimport useAsync from '../useAsync';\nimport useDebounceFn from '../useDebounceFn';\nimport useUpdateEffect from '../useUpdateEffect';\n\nfunction useSearch(fn, deps, options) {\n  var _deps = Array.isArray(deps) ? deps : [];\n\n  var _options = _typeof(deps) === 'object' && !Array.isArray(deps) ? deps : options || {};\n\n  var _useState = useState(''),\n      _useState2 = _slicedToArray(_useState, 2),\n      value = _useState2[0],\n      setValue = _useState2[1];\n\n  var _useAsync = useAsync(fn, [value].concat(_toConsumableArray(_deps)), {\n    manual: true\n  }),\n      loading = _useAsync.loading,\n      data = _useAsync.data,\n      run = _useAsync.run,\n      cancelAsync = _useAsync.cancel;\n\n  var wait = useMemo(function () {\n    return _options.wait === undefined ? 300 : _options.wait;\n  }, [_options.wait]);\n  var debounce = useDebounceFn(function () {\n    run(value);\n  }, [value], wait);\n  /* 依赖变化时，需要立即重新请求 */\n\n  useUpdateEffect(function () {\n    run(value);\n  }, _deps);\n  var cancel = useCallback(function () {\n    /* 先取消防抖 */\n    debounce.cancel();\n    /* 再取消 async */\n\n    cancelAsync();\n  }, [cancelAsync, debounce.cancel]);\n  /* 手动触发 */\n\n  var trigger = useCallback(function () {\n    run(value);\n  }, [run, value]);\n  return {\n    data: data,\n    loading: loading,\n    value: value,\n    onChange: setValue,\n    cancel: cancel,\n    run: trigger\n  };\n}\n\nexport default useSearch;","map":{"version":3,"sources":["E:/github-project/cloudMusic-mobile/node_modules/@umijs/hooks/es/useSearch/index.js"],"names":["_toConsumableArray","arr","_arrayWithoutHoles","_iterableToArray","_nonIterableSpread","TypeError","iter","Symbol","iterator","Object","prototype","toString","call","Array","from","isArray","i","arr2","length","_slicedToArray","_arrayWithHoles","_iterableToArrayLimit","_nonIterableRest","_arr","_n","_d","_e","undefined","_i","_s","next","done","push","value","err","_typeof","obj","constructor","useCallback","useMemo","useState","useAsync","useDebounceFn","useUpdateEffect","useSearch","fn","deps","options","_deps","_options","_useState","_useState2","setValue","_useAsync","concat","manual","loading","data","run","cancelAsync","cancel","wait","debounce","trigger","onChange"],"mappings":"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","sourcesContent":["function _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance\"); }\n\nfunction _iterableToArray(iter) { if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } }\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); }\n\nfunction _iterableToArrayLimit(arr, i) { if (!(Symbol.iterator in Object(arr) || Object.prototype.toString.call(arr) === \"[object Arguments]\")) { return; } var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nimport { useCallback, useMemo, useState } from 'react';\nimport useAsync from '../useAsync';\nimport useDebounceFn from '../useDebounceFn';\nimport useUpdateEffect from '../useUpdateEffect';\n\nfunction useSearch(fn, deps, options) {\n  var _deps = Array.isArray(deps) ? deps : [];\n\n  var _options = _typeof(deps) === 'object' && !Array.isArray(deps) ? deps : options || {};\n\n  var _useState = useState(''),\n      _useState2 = _slicedToArray(_useState, 2),\n      value = _useState2[0],\n      setValue = _useState2[1];\n\n  var _useAsync = useAsync(fn, [value].concat(_toConsumableArray(_deps)), {\n    manual: true\n  }),\n      loading = _useAsync.loading,\n      data = _useAsync.data,\n      run = _useAsync.run,\n      cancelAsync = _useAsync.cancel;\n\n  var wait = useMemo(function () {\n    return _options.wait === undefined ? 300 : _options.wait;\n  }, [_options.wait]);\n  var debounce = useDebounceFn(function () {\n    run(value);\n  }, [value], wait);\n  /* 依赖变化时，需要立即重新请求 */\n\n  useUpdateEffect(function () {\n    run(value);\n  }, _deps);\n  var cancel = useCallback(function () {\n    /* 先取消防抖 */\n    debounce.cancel();\n    /* 再取消 async */\n\n    cancelAsync();\n  }, [cancelAsync, debounce.cancel]);\n  /* 手动触发 */\n\n  var trigger = useCallback(function () {\n    run(value);\n  }, [run, value]);\n  return {\n    data: data,\n    loading: loading,\n    value: value,\n    onChange: setValue,\n    cancel: cancel,\n    run: trigger\n  };\n}\n\nexport default useSearch;"]},"metadata":{},"sourceType":"module"}