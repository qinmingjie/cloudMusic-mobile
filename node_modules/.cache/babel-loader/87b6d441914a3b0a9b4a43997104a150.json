{"ast":null,"code":"function _slicedToArray(arr, i) {\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest();\n}\n\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n}\n\nfunction _iterableToArrayLimit(arr, i) {\n  if (!(Symbol.iterator in Object(arr) || Object.prototype.toString.call(arr) === \"[object Arguments]\")) {\n    return;\n  }\n\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nimport { useState, useEffect, useRef } from 'react';\nvar initRect = {\n  top: NaN,\n  left: NaN,\n  bottom: NaN,\n  right: NaN,\n  height: NaN,\n  width: NaN\n};\n\nvar initState = _objectSpread({\n  text: ''\n}, initRect);\n\nfunction getRectFromSelection(selection) {\n  if (!selection) {\n    return initRect;\n  }\n\n  if (selection.rangeCount < 1) {\n    return initRect;\n  }\n\n  var range = selection.getRangeAt(0);\n\n  var _range$getBoundingCli = range.getBoundingClientRect(),\n      height = _range$getBoundingCli.height,\n      width = _range$getBoundingCli.width,\n      top = _range$getBoundingCli.top,\n      left = _range$getBoundingCli.left,\n      right = _range$getBoundingCli.right,\n      bottom = _range$getBoundingCli.bottom;\n\n  return {\n    height: height,\n    width: width,\n    top: top,\n    left: left,\n    right: right,\n    bottom: bottom\n  };\n}\n/**\n * 获取用户选取的文本或当前光标插入的位置\n * */\n\n\nfunction useTextSelection() {\n  var hasPassedInArg = arguments.length === 1;\n  var arg = useRef(arguments.length <= 0 ? undefined : arguments[0]);\n  var ref = useRef();\n\n  var _useState = useState(initState),\n      _useState2 = _slicedToArray(_useState, 2),\n      state = _useState2[0],\n      setState = _useState2[1];\n\n  var stateRef = useRef(state);\n  stateRef.current = state;\n  useEffect(function () {\n    // 获取 target 需要放在 useEffect 里，否则存在组件未加载好的情况而导致元素获取不到\n    var passedInArg = typeof arg.current === 'function' ? arg.current() : arg.current;\n    var target = hasPassedInArg ? passedInArg : ref.current;\n\n    if (!target) {\n      return function () {};\n    }\n\n    var mouseupHandler = function mouseupHandler() {\n      var selObj = null;\n      var text = '';\n      var rect = initRect;\n      if (!window.getSelection) return;\n      selObj = window.getSelection();\n      text = selObj ? selObj.toString() : '';\n\n      if (text) {\n        rect = getRectFromSelection(selObj);\n        setState(_objectSpread({}, state, {\n          text: text\n        }, rect));\n      }\n    }; // 任意点击都需要清空之前的 range\n\n\n    var mousedownHandler = function mousedownHandler() {\n      if (!window.getSelection) return;\n\n      if (stateRef.current.text) {\n        setState(_objectSpread({}, initState));\n      }\n\n      var selObj = window.getSelection();\n      if (!selObj) return;\n      selObj.removeAllRanges();\n    };\n\n    target.addEventListener('mouseup', mouseupHandler);\n    document.addEventListener('mousedown', mousedownHandler);\n    return function () {\n      target.removeEventListener('mouseup', mouseupHandler);\n      document.removeEventListener('mousedown', mousedownHandler);\n    };\n  }, [ref.current, typeof arg.current === 'function' ? undefined : arg.current]);\n\n  if (hasPassedInArg) {\n    return [state];\n  }\n\n  return [state, ref];\n}\n\nexport default useTextSelection;","map":{"version":3,"sources":["E:/github-project/cloudMusic-mobile/node_modules/@umijs/hooks/es/useTextSelection/index.js"],"names":["_slicedToArray","arr","i","_arrayWithHoles","_iterableToArrayLimit","_nonIterableRest","TypeError","Symbol","iterator","Object","prototype","toString","call","_arr","_n","_d","_e","undefined","_i","_s","next","done","push","value","length","err","Array","isArray","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","apply","_objectSpread","target","arguments","source","forEach","key","_defineProperty","getOwnPropertyDescriptors","defineProperties","defineProperty","obj","configurable","writable","useState","useEffect","useRef","initRect","top","NaN","left","bottom","right","height","width","initState","text","getRectFromSelection","selection","rangeCount","range","getRangeAt","_range$getBoundingCli","getBoundingClientRect","useTextSelection","hasPassedInArg","arg","ref","_useState","_useState2","state","setState","stateRef","current","passedInArg","mouseupHandler","selObj","rect","window","getSelection","mousedownHandler","removeAllRanges","addEventListener","document","removeEventListener"],"mappings":"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","sourcesContent":["function _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); }\n\nfunction _iterableToArrayLimit(arr, i) { if (!(Symbol.iterator in Object(arr) || Object.prototype.toString.call(arr) === \"[object Arguments]\")) { return; } var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport { useState, useEffect, useRef } from 'react';\nvar initRect = {\n  top: NaN,\n  left: NaN,\n  bottom: NaN,\n  right: NaN,\n  height: NaN,\n  width: NaN\n};\n\nvar initState = _objectSpread({\n  text: ''\n}, initRect);\n\nfunction getRectFromSelection(selection) {\n  if (!selection) {\n    return initRect;\n  }\n\n  if (selection.rangeCount < 1) {\n    return initRect;\n  }\n\n  var range = selection.getRangeAt(0);\n\n  var _range$getBoundingCli = range.getBoundingClientRect(),\n      height = _range$getBoundingCli.height,\n      width = _range$getBoundingCli.width,\n      top = _range$getBoundingCli.top,\n      left = _range$getBoundingCli.left,\n      right = _range$getBoundingCli.right,\n      bottom = _range$getBoundingCli.bottom;\n\n  return {\n    height: height,\n    width: width,\n    top: top,\n    left: left,\n    right: right,\n    bottom: bottom\n  };\n}\n/**\n * 获取用户选取的文本或当前光标插入的位置\n * */\n\n\nfunction useTextSelection() {\n  var hasPassedInArg = arguments.length === 1;\n  var arg = useRef(arguments.length <= 0 ? undefined : arguments[0]);\n  var ref = useRef();\n\n  var _useState = useState(initState),\n      _useState2 = _slicedToArray(_useState, 2),\n      state = _useState2[0],\n      setState = _useState2[1];\n\n  var stateRef = useRef(state);\n  stateRef.current = state;\n  useEffect(function () {\n    // 获取 target 需要放在 useEffect 里，否则存在组件未加载好的情况而导致元素获取不到\n    var passedInArg = typeof arg.current === 'function' ? arg.current() : arg.current;\n    var target = hasPassedInArg ? passedInArg : ref.current;\n\n    if (!target) {\n      return function () {};\n    }\n\n    var mouseupHandler = function mouseupHandler() {\n      var selObj = null;\n      var text = '';\n      var rect = initRect;\n      if (!window.getSelection) return;\n      selObj = window.getSelection();\n      text = selObj ? selObj.toString() : '';\n\n      if (text) {\n        rect = getRectFromSelection(selObj);\n        setState(_objectSpread({}, state, {\n          text: text\n        }, rect));\n      }\n    }; // 任意点击都需要清空之前的 range\n\n\n    var mousedownHandler = function mousedownHandler() {\n      if (!window.getSelection) return;\n\n      if (stateRef.current.text) {\n        setState(_objectSpread({}, initState));\n      }\n\n      var selObj = window.getSelection();\n      if (!selObj) return;\n      selObj.removeAllRanges();\n    };\n\n    target.addEventListener('mouseup', mouseupHandler);\n    document.addEventListener('mousedown', mousedownHandler);\n    return function () {\n      target.removeEventListener('mouseup', mouseupHandler);\n      document.removeEventListener('mousedown', mousedownHandler);\n    };\n  }, [ref.current, typeof arg.current === 'function' ? undefined : arg.current]);\n\n  if (hasPassedInArg) {\n    return [state];\n  }\n\n  return [state, ref];\n}\n\nexport default useTextSelection;"]},"metadata":{},"sourceType":"module"}