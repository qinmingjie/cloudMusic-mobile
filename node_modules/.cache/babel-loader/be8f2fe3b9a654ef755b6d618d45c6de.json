{"ast":null,"code":"var _jsxFileName = \"E:\\\\github-project\\\\cloudMusic-mobile\\\\src\\\\component\\\\musiclist.js\";\nimport React, { Fragment, useState, useEffect } from \"react\";\nimport musiclist from \"../static/css/musiclist.module.css\";\nimport { getUrl } from \"../store/action/index\";\nimport { createStore } from \"redux\";\nimport { useSelector, useDispatch } from \"react-redux\";\nexport default function MusicList(props) {\n  let {\n    data\n  } = props; // let [show,setShow] = useState(false)\n\n  let [musicLocation, setMuc] = useState(\"\");\n  let [musicSize, setSize] = useState([]);\n  useEffect(() => {// console.log(musicLocation)\n  }, [musicLocation]);\n  useEffect(() => {\n    let musiclist = document.querySelectorAll(\".musictr\");\n    let audio = document.querySelector(\"audio\");\n    let play = document.querySelector(\".playWrap\");\n    let cover = play.querySelector(\".cover\");\n\n    if (musiclist.length !== 0) {\n      [...musiclist].map((item, index) => {\n        item.onclick = function () {\n          let mucUrl = item.getAttribute(\"musicurl\");\n          let picUrl = item.getAttribute(\"album-id\");\n          getUrl(`/song/url?id=${mucUrl}`).then(res => {\n            let music = res.data.data[0].url;\n            console.log(music);\n\n            if (music !== null) {\n              cover.style.backgroundImage = `url(${picUrl})`;\n              cover.classList.add(\"anima\");\n              cover.style.animationPlayState = \"running\";\n              audio.setAttribute(\"src\", music);\n              play.querySelector(\".play\").style.display = \"block\";\n              play.querySelector(\".end\").style.display = \"none\";\n            } else {\n              alert(\"抱歉，暂时无法播放\");\n            }\n          });\n        };\n      });\n    }\n  }); //歌曲时间管理\n\n  function musicTimeReducer(time = {\n    data: [],\n    txt: \"123\"\n  }, action) {\n    if (action.type === \"time_data\") {\n      return {\n        data: action.data\n      };\n    }\n\n    return time;\n  }\n\n  let store = createStore(musicTimeReducer);\n\n  function getData(long) {\n    let str = \"\";\n    getUrl(`/song/url?id=${long}`).then(res => {\n      str += \",\" + res.data.data[0].size;\n      store.dispatch({\n        type: \"time_data\",\n        data: store.getState().data + str\n      }); // store.getState().data\n    });\n  } // store.dispatch({\n  //     type:\"time_data\",\n  //     data:\"123456\"\n  // })\n  // function longTime(long){\n  //     getUrl(`/song/url?id=${long}`).then((res)=>{\n  //         store.dispatch({\n  //             type:\"time_data\",\n  //             data:res.data.data[0].size\n  //         })\n  //     }).then(()=>{\n  //         musicSize.push(store.getState().data)\n  //     }).then(()=>{\n  //         let timeElement = document.querySelectorAll(\".timeElement\")\n  //         timeElement = [...timeElement]\n  //         console.log(timeElement)\n  //         console.log(musicSize)\n  //         musicSize.map((item,index)=>{\n  //         //    console.log(index)\n  //         })\n  //     })\n  // }\n\n\n  return /*#__PURE__*/React.createElement(Fragment, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 9\n    }\n  }, data ? /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: musiclist.title,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 22\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 29\n    }\n  }, \"\\u6B4C\\u66F2\\u5217\\u8868\")), /*#__PURE__*/React.createElement(\"span\", {\n    className: musiclist.numbers,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 29\n    }\n  }, data.trackCount), \"\\u9996\\u6B4C\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: musiclist.playnumber,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 25\n    }\n  }, \"\\u64AD\\u653E\\uFF1A\", /*#__PURE__*/React.createElement(\"strong\", {\n    className: musiclist.red,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 66\n    }\n  }, data.playCount), \" \\u6B21\"), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 25\n    }\n  })), /*#__PURE__*/React.createElement(\"table\", {\n    className: musiclist.table,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"thead\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"tr\", {\n    className: musiclist.thead,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"th\", {\n    className: musiclist.head1,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 61\n    }\n  })), /*#__PURE__*/React.createElement(\"th\", {\n    className: musiclist.head2,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 61\n    }\n  }, \"\\u6B4C\\u66F2\\u6807\\u9898\")), /*#__PURE__*/React.createElement(\"th\", {\n    className: musiclist.head3,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 61\n    }\n  }, \"\\u65F6\\u957F\")), /*#__PURE__*/React.createElement(\"th\", {\n    className: musiclist.head4,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 61\n    }\n  }, \"\\u6B4C\\u624B\")), /*#__PURE__*/React.createElement(\"th\", {\n    className: musiclist.head5,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 61\n    }\n  }, \"\\u4E13\\u8F91\")))), /*#__PURE__*/React.createElement(\"tbody\", {\n    className: musiclist.tbody,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 21\n    }\n  }, data.tracks.map((item, index) => {\n    getData(item.id);\n    return /*#__PURE__*/React.createElement(\"tr\", {\n      key: item.id,\n      musicurl: item.id,\n      \"album-id\": item.al.picUrl,\n      hasshow: \"show\",\n      className: ((index + 1) % 2 === 0 ? \"\" : musiclist.gray) + \" \" + \"musictr\",\n      onMouseEnter: function (e) {\n        let parentnode = e.target;\n\n        function Parent() {\n          if (parentnode.parentElement.getAttribute(\"hasshow\")) {\n            parentnode.parentElement.querySelector(\"#time\").style.display = \"none\";\n            parentnode.parentElement.querySelector(\"#timeIcons\").style.display = \"block\";\n          } else {\n            parentnode = parentnode.parentElement;\n            Parent();\n          }\n        }\n\n        Parent();\n      },\n      onClick: e => {\n        {\n          /**该点击时间中都是异步操作，音乐地址需要在点击时获取这是有的数据没有请求到就会出错所以使用Promise来同步异步操作 */\n        }\n        getUrl(`/song/url?id=${item.id}`).then(res => {\n          function muc(Data) {\n            return new Promise((reslove, reject) => {\n              setMuc(Data);\n            });\n          }\n\n          muc(res.data.data[0].url).then(() => {\n            if (musicLocation === null) {\n              alert(\"为获取到版权,努力中！\");\n            }\n          });\n        });\n      },\n      onMouseLeave: function (e) {\n        let parentnode = e.target;\n\n        function Parent() {\n          if (parentnode.parentElement.getAttribute(\"hasshow\")) {\n            parentnode.parentElement.querySelector(\"#time\").style.display = \"block\";\n            parentnode.parentElement.querySelector(\"#timeIcons\").style.display = \"none\";\n          } else {\n            parentnode = parentnode.parentElement;\n            Parent();\n          }\n        }\n\n        Parent();\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 33\n      }\n    }, /*#__PURE__*/React.createElement(\"td\", {\n      className: musiclist.num,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 162,\n        columnNumber: 37\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163,\n        columnNumber: 41\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      className: musiclist.icon1,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 45\n      }\n    }, \"\\xA0\"), /*#__PURE__*/React.createElement(\"span\", {\n      className: musiclist.num,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 45\n      }\n    }, index + 1))), /*#__PURE__*/React.createElement(\"td\", {\n      className: musiclist.muscName,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168,\n        columnNumber: 37\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169,\n        columnNumber: 41\n      }\n    }, item.name)), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 173,\n        columnNumber: 37\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: musiclist.share,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 174,\n        columnNumber: 41\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      className: musiclist.time + \" \" + \"timeElement\",\n      id: \"time\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 175,\n        columnNumber: 45\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: musiclist.show,\n      id: \"timeIcons\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 176,\n        columnNumber: 45\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      className: musiclist.span1,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177,\n        columnNumber: 49\n      }\n    }), /*#__PURE__*/React.createElement(\"span\", {\n      className: musiclist.span2,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178,\n        columnNumber: 49\n      }\n    }), /*#__PURE__*/React.createElement(\"span\", {\n      className: musiclist.span3,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 179,\n        columnNumber: 49\n      }\n    }), /*#__PURE__*/React.createElement(\"span\", {\n      className: musiclist.span4,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 180,\n        columnNumber: 49\n      }\n    })))), /*#__PURE__*/React.createElement(\"td\", {\n      className: \"\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184,\n        columnNumber: 37\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: musiclist.song,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 185,\n        columnNumber: 41\n      }\n    }, item.ar[0].name)), /*#__PURE__*/React.createElement(\"td\", {\n      className: \"\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 189,\n        columnNumber: 37\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: musiclist.album,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 190,\n        columnNumber: 41\n      }\n    }, item.al.name)));\n  })))) : \"\");\n}","map":{"version":3,"sources":["E:/github-project/cloudMusic-mobile/src/component/musiclist.js"],"names":["React","Fragment","useState","useEffect","musiclist","getUrl","createStore","useSelector","useDispatch","MusicList","props","data","musicLocation","setMuc","musicSize","setSize","document","querySelectorAll","audio","querySelector","play","cover","length","map","item","index","onclick","mucUrl","getAttribute","picUrl","then","res","music","url","console","log","style","backgroundImage","classList","add","animationPlayState","setAttribute","display","alert","musicTimeReducer","time","txt","action","type","store","getData","long","str","size","dispatch","getState","title","numbers","trackCount","playnumber","red","playCount","table","thead","head1","head2","head3","head4","head5","tbody","tracks","id","al","gray","e","parentnode","target","Parent","parentElement","muc","Data","Promise","reslove","reject","num","icon1","muscName","name","share","show","span1","span2","span3","span4","song","ar","album"],"mappings":"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","sourcesContent":["import React,{Fragment, useState, useEffect}from \"react\"\r\nimport musiclist from \"../static/css/musiclist.module.css\"\r\nimport {getUrl} from \"../store/action/index\"\r\nimport {createStore} from \"redux\"\r\nimport {useSelector,useDispatch} from \"react-redux\"\r\nexport default function MusicList(props){\r\n    let {data} = props\r\n    // let [show,setShow] = useState(false)\r\n    let [musicLocation,setMuc] = useState(\"\");\r\n    let [musicSize,setSize] = useState([])\r\n    useEffect(()=>{\r\n        // console.log(musicLocation)\r\n    },[musicLocation])\r\n    useEffect(()=>{\r\n        let musiclist = document.querySelectorAll(\".musictr\")\r\n        let audio = document.querySelector(\"audio\")\r\n        let play = document.querySelector(\".playWrap\")\r\n        let cover = play.querySelector(\".cover\")\r\n        if(musiclist.length!==0){\r\n            [...musiclist].map((item,index)=>{\r\n                item.onclick=function(){\r\n                    let mucUrl = item.getAttribute(\"musicurl\")\r\n                    let picUrl = item.getAttribute(\"album-id\")\r\n                    getUrl(`/song/url?id=${mucUrl}`).then((res)=>{\r\n                        let music = res.data.data[0].url;\r\n                        console.log(music)\r\n                        if(music!==null){\r\n                            cover.style.backgroundImage = `url(${picUrl})`;\r\n                            cover.classList.add(\"anima\")\r\n                            cover.style.animationPlayState = \"running\"\r\n                            audio.setAttribute(\"src\",music)\r\n                            play.querySelector(\".play\").style.display=\"block\"\r\n                            play.querySelector(\".end\").style.display=\"none\"\r\n                        }else{\r\n                            alert(\"抱歉，暂时无法播放\")\r\n                        }\r\n                    })\r\n                }\r\n            })\r\n        }\r\n        \r\n        \r\n    })\r\n\r\n    //歌曲时间管理\r\n    function musicTimeReducer(time={\r\n        data:[],\r\n        txt:\"123\"\r\n    },action){\r\n        if(action.type===\"time_data\"){\r\n            return {data:action.data}\r\n        }\r\n        return time\r\n    }\r\n    let store = createStore(musicTimeReducer);\r\n    function getData(long){\r\n        let str = \"\";\r\n        getUrl(`/song/url?id=${long}`).then((res)=>{\r\n            str += \",\"+res.data.data[0].size\r\n            store.dispatch({\r\n                type:\"time_data\",\r\n                data:store.getState().data+str,\r\n            })\r\n            // store.getState().data\r\n        })\r\n    }\r\n    // store.dispatch({\r\n    //     type:\"time_data\",\r\n    //     data:\"123456\"\r\n    // })\r\n    // function longTime(long){\r\n    //     getUrl(`/song/url?id=${long}`).then((res)=>{\r\n    //         store.dispatch({\r\n    //             type:\"time_data\",\r\n    //             data:res.data.data[0].size\r\n    //         })\r\n    //     }).then(()=>{\r\n    //         musicSize.push(store.getState().data)\r\n    //     }).then(()=>{\r\n    //         let timeElement = document.querySelectorAll(\".timeElement\")\r\n    //         timeElement = [...timeElement]\r\n    //         console.log(timeElement)\r\n    //         console.log(musicSize)\r\n    //         musicSize.map((item,index)=>{\r\n    //         //    console.log(index)\r\n    //         })\r\n    //     })\r\n        \r\n    // }\r\n    return(\r\n        <Fragment>\r\n            {data?(\r\n                <div>\r\n                     <div className={musiclist.title}>\r\n                        <h3>\r\n                            <span>歌曲列表</span>\r\n                        </h3>\r\n                        <span className={musiclist.numbers}>\r\n                            <span>{data.trackCount}</span>首歌\r\n                        </span>\r\n                        <div className={musiclist.playnumber}>播放：<strong  className={musiclist.red}>{data.playCount}</strong> 次</div>\r\n                        <div>\r\n                        </div>\r\n                    </div>\r\n                <table className={musiclist.table}>\r\n                    <thead>\r\n                        <tr className={musiclist.thead}>\r\n                            <th className={musiclist.head1}><div></div></th>\r\n                            <th className={musiclist.head2}><div>歌曲标题</div></th>\r\n                            <th className={musiclist.head3}><div>时长</div></th>\r\n                            <th className={musiclist.head4}><div>歌手</div></th>\r\n                            <th className={musiclist.head5}><div>专辑</div></th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody className={musiclist.tbody}>\r\n                        {data.tracks.map((item,index)=>{\r\n                            getData(item.id)\r\n                            return(\r\n                                <tr key={item.id} musicurl={item.id}  album-id={item.al.picUrl} hasshow=\"show\" className={(((index+1)%2===0)?\"\":musiclist.gray)+\" \"+\"musictr\"} \r\n                                onMouseEnter={function(e){\r\n                                    let parentnode = e.target;\r\n                                    function Parent(){\r\n                                        if(parentnode.parentElement.getAttribute(\"hasshow\")){\r\n                                           parentnode.parentElement.querySelector(\"#time\").style.display = \"none\";\r\n                                           parentnode.parentElement.querySelector(\"#timeIcons\").style.display = \"block\"\r\n                                        }else{\r\n                                            parentnode = parentnode.parentElement\r\n                                            Parent()\r\n                                        }\r\n                                    }\r\n                                    Parent()\r\n                                }}\r\n                                onClick={(e)=>{\r\n                                    {/**该点击时间中都是异步操作，音乐地址需要在点击时获取这是有的数据没有请求到就会出错所以使用Promise来同步异步操作 */}\r\n                                    getUrl(`/song/url?id=${item.id}`).then((res)=>{\r\n                                        function muc(Data){\r\n                                            return new Promise((reslove,reject)=>{\r\n                                                setMuc(Data)\r\n                                            })\r\n                                        }\r\n                                        muc(res.data.data[0].url).then(()=>{\r\n                                            if(musicLocation===null){\r\n                                                alert(\"为获取到版权,努力中！\")\r\n                                            }\r\n                                        })\r\n                                    })\r\n                                }}\r\n                                onMouseLeave={function(e){\r\n                                    let parentnode = e.target;\r\n                                    function Parent(){\r\n                                        if(parentnode.parentElement.getAttribute(\"hasshow\")){\r\n                                           parentnode.parentElement.querySelector(\"#time\").style.display = \"block\";\r\n                                           parentnode.parentElement.querySelector(\"#timeIcons\").style.display = \"none\"\r\n                                        }else{\r\n                                            parentnode = parentnode.parentElement\r\n                                            Parent()\r\n                                        }\r\n                                    }\r\n                                    Parent()\r\n                                }}\r\n                                >\r\n                                    <td className={musiclist.num}>\r\n                                        <div>\r\n                                            <span className={musiclist.icon1}>&nbsp;</span>\r\n                                            <span  className={musiclist.num}>{index+1}</span>\r\n                                        </div>\r\n                                    </td>\r\n                                    <td className={musiclist.muscName}>\r\n                                        <div>\r\n                                           {item.name}\r\n                                        </div>\r\n                                    </td>\r\n                                    <td>\r\n                                        <div className={musiclist.share}>\r\n                                            <span className={musiclist.time+\" \"+\"timeElement\"}  id=\"time\"></span>\r\n                                            <div className={musiclist.show} id=\"timeIcons\">\r\n                                                <span className={musiclist.span1}></span>\r\n                                                <span className={musiclist.span2}></span>\r\n                                                <span className={musiclist.span3}></span>\r\n                                                <span className={musiclist.span4}></span>\r\n                                            </div>\r\n                                        </div>\r\n                                    </td>\r\n                                    <td className=\"\">\r\n                                        <div className={musiclist.song}>\r\n                                            {item.ar[0].name}\r\n                                        </div>\r\n                                    </td>\r\n                                    <td className=\"\">\r\n                                        <div className={musiclist.album}>\r\n                                            {item.al.name}\r\n                                        </div>\r\n                                    </td>\r\n                                </tr>\r\n                            )\r\n                        })}\r\n                        </tbody>\r\n                </table>\r\n                </div>\r\n               ):\"\"}\r\n        </Fragment>\r\n    )\r\n}"]},"metadata":{},"sourceType":"module"}